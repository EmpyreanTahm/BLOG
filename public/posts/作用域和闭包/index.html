<!DOCTYPE html>
<html lang="zh-cn">
<head>
  <link rel="preload" href="/lib/font-awesome/webfonts/fa-brands-400.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="preload" href="/lib/font-awesome/webfonts/fa-regular-400.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="preload" href="/lib/font-awesome/webfonts/fa-solid-900.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="preload" href="/lib/JetBrainsMono/web/woff2/JetBrainsMono-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <script type="text/javascript" src="https://latest.cactus.chat/cactus.js"></script>
  <link rel="stylesheet" href="https://latest.cactus.chat/style.css" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title> 作用域和闭包 | GeekKery</title>
  <meta name="google-site-verification" content="FZMz_7s8NfUWqk6Jhj7XTO-uF-fCf8GNLP3a9Ki95rQ" />
  <link rel = 'canonical' href = 'https://geekkery.4everland.app/posts/%E4%BD%9C%E7%94%A8%E5%9F%9F%E5%92%8C%E9%97%AD%E5%8C%85/'>
  <meta name="description" content="GeekKery | Jayden 的个人博客 | web 前端技术文章">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="robots" content="all,follow">
  <meta name="googlebot" content="index,follow,snippet,archive">
  <meta property="og:title" content="作用域和闭包" />
<meta property="og:description" content="词法作用域 作用域是一套规则，这套规则用来管理引擎如何在当前的作用域以及嵌套的子作用域中根据标识符名称进行变量查找。作用域共有两种主要的工作模型。第一种是最为普遍的，被大多数编程语言所采用的词法作用域，另外一种叫做动态作用域，仍有一些编程语言在使用（比如 Bash 脚本、Perl 中的一些模式等）。JavaScript 中的作用域就是词法作用域。
词法作用域就是定义在词法阶段的作用域。换句话说，词法作用域是由你在写代码时将变量和块作用域写在哪里来决定的，因此当词法分析器处理代码时会保持作用域不变。无论函数在哪里被调用，也无论它如何被调用，它的词法作用域都只由函数被声明时所处的位置决定。
欺骗词法 如果词法作用域完全由写代码期间函数所声明的位置来定义，怎样才能在运行时来“修改”（即欺骗）词法作用域呢？
JavaScript 中有两种机制来实现这个目的：eval(..) 函数和 with 关键字。前者可以对一段包含一个或多个声明的“代码”字符串进行演算，并借此来修改已经存在的词法作用域（在运行时）。后者本质上是通过将一个对象的引用当作作用域来处理，将对象的属性当作作用域中的标识符来处理，从而创建了一个新的词法作用域（同样是在运行时）。
这两个机制的副作用是引擎无法在编译时对作用域查找进行优化，因为引擎只能谨慎地认为这样的优化是无效的。使用这其中任何一个机制都将导致代码运行变慢。避免使用它们。
动态作用域 动态作用域并不关心函数和作用域是如何声明以及在何处声明的，只关心它们从何处调用。换句话说，作用域链是基于调用栈的，而不是代码中的作用域嵌套。
因此，如果 JavaScript 具有动态作用域，理论上，下面代码中的 foo() 在执行时将会输出 3。
1function foo() { 2	console.log(a) // 3(不是 2 !) 3} 4function bar() { 5 var a = 3 6	foo() 7} 8var a = 2 9bar() 为什么会这样？因为当 foo() 无法找到 a 的变量引用时，会顺着调用栈在调用 foo() 的地方查找 a，而不是在嵌套的词法作用域链中向上查找。由于 foo() 是在 bar() 中调用的，引擎会检查 bar() 的作用域，并在其中找到值为 3 的变量 a。
需要明确的是，事实上 JavaScript 并不具有动态作用域。它只有词法作用域，简单明了。但是 this 机制某种程度上很像动态作用域。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://geekkery.4everland.app/posts/%E4%BD%9C%E7%94%A8%E5%9F%9F%E5%92%8C%E9%97%AD%E5%8C%85/" />
<meta property="article:published_time" content="2021-01-18T15:03:44+08:00" />
<meta property="article:modified_time" content="2021-01-18T15:03:44+08:00" />

  <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="作用域和闭包"/>
<meta name="twitter:description" content="词法作用域 作用域是一套规则，这套规则用来管理引擎如何在当前的作用域以及嵌套的子作用域中根据标识符名称进行变量查找。作用域共有两种主要的工作模型。第一种是最为普遍的，被大多数编程语言所采用的词法作用域，另外一种叫做动态作用域，仍有一些编程语言在使用（比如 Bash 脚本、Perl 中的一些模式等）。JavaScript 中的作用域就是词法作用域。
词法作用域就是定义在词法阶段的作用域。换句话说，词法作用域是由你在写代码时将变量和块作用域写在哪里来决定的，因此当词法分析器处理代码时会保持作用域不变。无论函数在哪里被调用，也无论它如何被调用，它的词法作用域都只由函数被声明时所处的位置决定。
欺骗词法 如果词法作用域完全由写代码期间函数所声明的位置来定义，怎样才能在运行时来“修改”（即欺骗）词法作用域呢？
JavaScript 中有两种机制来实现这个目的：eval(..) 函数和 with 关键字。前者可以对一段包含一个或多个声明的“代码”字符串进行演算，并借此来修改已经存在的词法作用域（在运行时）。后者本质上是通过将一个对象的引用当作作用域来处理，将对象的属性当作作用域中的标识符来处理，从而创建了一个新的词法作用域（同样是在运行时）。
这两个机制的副作用是引擎无法在编译时对作用域查找进行优化，因为引擎只能谨慎地认为这样的优化是无效的。使用这其中任何一个机制都将导致代码运行变慢。避免使用它们。
动态作用域 动态作用域并不关心函数和作用域是如何声明以及在何处声明的，只关心它们从何处调用。换句话说，作用域链是基于调用栈的，而不是代码中的作用域嵌套。
因此，如果 JavaScript 具有动态作用域，理论上，下面代码中的 foo() 在执行时将会输出 3。
1function foo() { 2	console.log(a) // 3(不是 2 !) 3} 4function bar() { 5 var a = 3 6	foo() 7} 8var a = 2 9bar() 为什么会这样？因为当 foo() 无法找到 a 的变量引用时，会顺着调用栈在调用 foo() 的地方查找 a，而不是在嵌套的词法作用域链中向上查找。由于 foo() 是在 bar() 中调用的，引擎会检查 bar() 的作用域，并在其中找到值为 3 的变量 a。
需要明确的是，事实上 JavaScript 并不具有动态作用域。它只有词法作用域，简单明了。但是 this 机制某种程度上很像动态作用域。"/>

  
  
    
  
  
  <link rel="stylesheet" href="https://geekkery.4everland.app/css/styles.c05d68261bf086a9d7713c4f8a6215a3601608e267a816a7ee58f139b3d1aae51222aae2081c8e0c6bd35e1334773b7a16283022f31f92afd93bb37e5e822e66.css" integrity="sha512-wF1oJhvwhqnXcTxPimIVo2AWCOJnqBan7ljxObPRquUSIqriCByODGvTXhM0dzt6FigwIvMfkq/ZO7N&#43;XoIuZg==">

  
  
  
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  

  
<link rel="icon" type="image/png" href="https://geekkery.4everland.app/images/favicon.ico" />

  
  
  
  
</head>

<body class="max-width mx-auto px3 ltr">
  <div class="content index py4">

  <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;" aria-label="Top of Page"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
        <li><a href="/">Home</a></li>
         
        <li><a href="/posts">Writings</a></li>
         
        <li><a href="/tags">Tags</a></li>
         
        <li><a href="/about">About</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li>
          <a class="icon" href=" https://geekkery.4everland.app/posts/%E6%B5%85%E6%9E%90-https/" aria-label="Previous">
            <i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i>
          </a>
        </li>
        
        
        <li>
          <a class="icon" href="https://geekkery.4everland.app/posts/%E6%B5%85%E8%B0%88-gc/" aria-label="Next">
            <i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i>
          </a>
        </li>
        
        <li>
          <a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" aria-label="Top of Page">
            <i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i>
          </a>
        </li>
        <li>
          <a class="icon" href="#" aria-label="Share">
            <i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i>
          </a>
        </li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      
      <ul>
  
  
    
  
  
  <li>
    <a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fgeekkery.4everland.app%2fposts%2f%25E4%25BD%259C%25E7%2594%25A8%25E5%259F%259F%25E5%2592%258C%25E9%2597%25AD%25E5%258C%2585%2f" aria-label="Facebook">
      <i class="fab fa-facebook " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://twitter.com/share?url=https%3a%2f%2fgeekkery.4everland.app%2fposts%2f%25E4%25BD%259C%25E7%2594%25A8%25E5%259F%259F%25E5%2592%258C%25E9%2597%25AD%25E5%258C%2585%2f&text=%e4%bd%9c%e7%94%a8%e5%9f%9f%e5%92%8c%e9%97%ad%e5%8c%85" aria-label="Twitter">
      <i class="fab fa-twitter " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fgeekkery.4everland.app%2fposts%2f%25E4%25BD%259C%25E7%2594%25A8%25E5%259F%259F%25E5%2592%258C%25E9%2597%25AD%25E5%258C%2585%2f&title=%e4%bd%9c%e7%94%a8%e5%9f%9f%e5%92%8c%e9%97%ad%e5%8c%85" aria-label="Linkedin">
      <i class="fab fa-linkedin " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fgeekkery.4everland.app%2fposts%2f%25E4%25BD%259C%25E7%2594%25A8%25E5%259F%259F%25E5%2592%258C%25E9%2597%25AD%25E5%258C%2585%2f&is_video=false&description=%e4%bd%9c%e7%94%a8%e5%9f%9f%e5%92%8c%e9%97%ad%e5%8c%85" aria-label="Pinterest">
      <i class="fab fa-pinterest " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="mailto:?subject=%e4%bd%9c%e7%94%a8%e5%9f%9f%e5%92%8c%e9%97%ad%e5%8c%85&body=Check out this article: https%3a%2f%2fgeekkery.4everland.app%2fposts%2f%25E4%25BD%259C%25E7%2594%25A8%25E5%259F%259F%25E5%2592%258C%25E9%2597%25AD%25E5%258C%2585%2f" aria-label="Email">
      <i class="fas fa-envelope " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2fgeekkery.4everland.app%2fposts%2f%25E4%25BD%259C%25E7%2594%25A8%25E5%259F%259F%25E5%2592%258C%25E9%2597%25AD%25E5%258C%2585%2f&title=%e4%bd%9c%e7%94%a8%e5%9f%9f%e5%92%8c%e9%97%ad%e5%8c%85" aria-label="Pocket">
      <i class="fab fa-get-pocket " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2fgeekkery.4everland.app%2fposts%2f%25E4%25BD%259C%25E7%2594%25A8%25E5%259F%259F%25E5%2592%258C%25E9%2597%25AD%25E5%258C%2585%2f&title=%e4%bd%9c%e7%94%a8%e5%9f%9f%e5%92%8c%e9%97%ad%e5%8c%85" aria-label="reddit">
      <i class="fab fa-reddit " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.tumblr.com/share/link?url=https%3a%2f%2fgeekkery.4everland.app%2fposts%2f%25E4%25BD%259C%25E7%2594%25A8%25E5%259F%259F%25E5%2592%258C%25E9%2597%25AD%25E5%258C%2585%2f&name=%e4%bd%9c%e7%94%a8%e5%9f%9f%e5%92%8c%e9%97%ad%e5%8c%85&description=%e8%af%8d%e6%b3%95%e4%bd%9c%e7%94%a8%e5%9f%9f%20%e4%bd%9c%e7%94%a8%e5%9f%9f%e6%98%af%e4%b8%80%e5%a5%97%e8%a7%84%e5%88%99%ef%bc%8c%e8%bf%99%e5%a5%97%e8%a7%84%e5%88%99%e7%94%a8%e6%9d%a5%e7%ae%a1%e7%90%86%e5%bc%95%e6%93%8e%e5%a6%82%e4%bd%95%e5%9c%a8%e5%bd%93%e5%89%8d%e7%9a%84%e4%bd%9c%e7%94%a8%e5%9f%9f%e4%bb%a5%e5%8f%8a%e5%b5%8c%e5%a5%97%e7%9a%84%e5%ad%90%e4%bd%9c%e7%94%a8%e5%9f%9f%e4%b8%ad%e6%a0%b9%e6%8d%ae%e6%a0%87%e8%af%86%e7%ac%a6%e5%90%8d%e7%a7%b0%e8%bf%9b%e8%a1%8c%e5%8f%98%e9%87%8f%e6%9f%a5%e6%89%be%e3%80%82%e4%bd%9c%e7%94%a8%e5%9f%9f%e5%85%b1%e6%9c%89%e4%b8%a4%e7%a7%8d%e4%b8%bb%e8%a6%81%e7%9a%84%e5%b7%a5%e4%bd%9c%e6%a8%a1%e5%9e%8b%e3%80%82%e7%ac%ac%e4%b8%80%e7%a7%8d%e6%98%af%e6%9c%80%e4%b8%ba%e6%99%ae%e9%81%8d%e7%9a%84%ef%bc%8c%e8%a2%ab%e5%a4%a7%e5%a4%9a%e6%95%b0%e7%bc%96%e7%a8%8b%e8%af%ad%e8%a8%80%e6%89%80%e9%87%87%e7%94%a8%e7%9a%84%e8%af%8d%e6%b3%95%e4%bd%9c%e7%94%a8%e5%9f%9f%ef%bc%8c%e5%8f%a6%e5%a4%96%e4%b8%80%e7%a7%8d%e5%8f%ab%e5%81%9a%e5%8a%a8%e6%80%81%e4%bd%9c%e7%94%a8%e5%9f%9f%ef%bc%8c%e4%bb%8d%e6%9c%89%e4%b8%80%e4%ba%9b%e7%bc%96%e7%a8%8b%e8%af%ad%e8%a8%80%e5%9c%a8%e4%bd%bf%e7%94%a8%ef%bc%88%e6%af%94%e5%a6%82%20Bash%20%e8%84%9a%e6%9c%ac%e3%80%81Perl%20%e4%b8%ad%e7%9a%84%e4%b8%80%e4%ba%9b%e6%a8%a1%e5%bc%8f%e7%ad%89%ef%bc%89%e3%80%82JavaScript%20%e4%b8%ad%e7%9a%84%e4%bd%9c%e7%94%a8%e5%9f%9f%e5%b0%b1%e6%98%af%e8%af%8d%e6%b3%95%e4%bd%9c%e7%94%a8%e5%9f%9f%e3%80%82%0a%e8%af%8d%e6%b3%95%e4%bd%9c%e7%94%a8%e5%9f%9f%e5%b0%b1%e6%98%af%e5%ae%9a%e4%b9%89%e5%9c%a8%e8%af%8d%e6%b3%95%e9%98%b6%e6%ae%b5%e7%9a%84%e4%bd%9c%e7%94%a8%e5%9f%9f%e3%80%82%e6%8d%a2%e5%8f%a5%e8%af%9d%e8%af%b4%ef%bc%8c%e8%af%8d%e6%b3%95%e4%bd%9c%e7%94%a8%e5%9f%9f%e6%98%af%e7%94%b1%e4%bd%a0%e5%9c%a8%e5%86%99%e4%bb%a3%e7%a0%81%e6%97%b6%e5%b0%86%e5%8f%98%e9%87%8f%e5%92%8c%e5%9d%97%e4%bd%9c%e7%94%a8%e5%9f%9f%e5%86%99%e5%9c%a8%e5%93%aa%e9%87%8c%e6%9d%a5%e5%86%b3%e5%ae%9a%e7%9a%84%ef%bc%8c%e5%9b%a0%e6%ad%a4%e5%bd%93%e8%af%8d%e6%b3%95%e5%88%86%e6%9e%90%e5%99%a8%e5%a4%84%e7%90%86%e4%bb%a3%e7%a0%81%e6%97%b6%e4%bc%9a%e4%bf%9d%e6%8c%81%e4%bd%9c%e7%94%a8%e5%9f%9f%e4%b8%8d%e5%8f%98%e3%80%82%e6%97%a0%e8%ae%ba%e5%87%bd%e6%95%b0%e5%9c%a8%e5%93%aa%e9%87%8c%e8%a2%ab%e8%b0%83%e7%94%a8%ef%bc%8c%e4%b9%9f%e6%97%a0%e8%ae%ba%e5%ae%83%e5%a6%82%e4%bd%95%e8%a2%ab%e8%b0%83%e7%94%a8%ef%bc%8c%e5%ae%83%e7%9a%84%e8%af%8d%e6%b3%95%e4%bd%9c%e7%94%a8%e5%9f%9f%e9%83%bd%e5%8f%aa%e7%94%b1%e5%87%bd%e6%95%b0%e8%a2%ab%e5%a3%b0%e6%98%8e%e6%97%b6%e6%89%80%e5%a4%84%e7%9a%84%e4%bd%8d%e7%bd%ae%e5%86%b3%e5%ae%9a%e3%80%82%0a%e6%ac%ba%e9%aa%97%e8%af%8d%e6%b3%95%20%e5%a6%82%e6%9e%9c%e8%af%8d%e6%b3%95%e4%bd%9c%e7%94%a8%e5%9f%9f%e5%ae%8c%e5%85%a8%e7%94%b1%e5%86%99%e4%bb%a3%e7%a0%81%e6%9c%9f%e9%97%b4%e5%87%bd%e6%95%b0%e6%89%80%e5%a3%b0%e6%98%8e%e7%9a%84%e4%bd%8d%e7%bd%ae%e6%9d%a5%e5%ae%9a%e4%b9%89%ef%bc%8c%e6%80%8e%e6%a0%b7%e6%89%8d%e8%83%bd%e5%9c%a8%e8%bf%90%e8%a1%8c%e6%97%b6%e6%9d%a5%e2%80%9c%e4%bf%ae%e6%94%b9%e2%80%9d%ef%bc%88%e5%8d%b3%e6%ac%ba%e9%aa%97%ef%bc%89%e8%af%8d%e6%b3%95%e4%bd%9c%e7%94%a8%e5%9f%9f%e5%91%a2%ef%bc%9f%0aJavaScript%20%e4%b8%ad%e6%9c%89%e4%b8%a4%e7%a7%8d%e6%9c%ba%e5%88%b6%e6%9d%a5%e5%ae%9e%e7%8e%b0%e8%bf%99%e4%b8%aa%e7%9b%ae%e7%9a%84%ef%bc%9aeval%28..%29%20%e5%87%bd%e6%95%b0%e5%92%8c%20with%20%e5%85%b3%e9%94%ae%e5%ad%97%e3%80%82%e5%89%8d%e8%80%85%e5%8f%af%e4%bb%a5%e5%af%b9%e4%b8%80%e6%ae%b5%e5%8c%85%e5%90%ab%e4%b8%80%e4%b8%aa%e6%88%96%e5%a4%9a%e4%b8%aa%e5%a3%b0%e6%98%8e%e7%9a%84%e2%80%9c%e4%bb%a3%e7%a0%81%e2%80%9d%e5%ad%97%e7%ac%a6%e4%b8%b2%e8%bf%9b%e8%a1%8c%e6%bc%94%e7%ae%97%ef%bc%8c%e5%b9%b6%e5%80%9f%e6%ad%a4%e6%9d%a5%e4%bf%ae%e6%94%b9%e5%b7%b2%e7%bb%8f%e5%ad%98%e5%9c%a8%e7%9a%84%e8%af%8d%e6%b3%95%e4%bd%9c%e7%94%a8%e5%9f%9f%ef%bc%88%e5%9c%a8%e8%bf%90%e8%a1%8c%e6%97%b6%ef%bc%89%e3%80%82%e5%90%8e%e8%80%85%e6%9c%ac%e8%b4%a8%e4%b8%8a%e6%98%af%e9%80%9a%e8%bf%87%e5%b0%86%e4%b8%80%e4%b8%aa%e5%af%b9%e8%b1%a1%e7%9a%84%e5%bc%95%e7%94%a8%e5%bd%93%e4%bd%9c%e4%bd%9c%e7%94%a8%e5%9f%9f%e6%9d%a5%e5%a4%84%e7%90%86%ef%bc%8c%e5%b0%86%e5%af%b9%e8%b1%a1%e7%9a%84%e5%b1%9e%e6%80%a7%e5%bd%93%e4%bd%9c%e4%bd%9c%e7%94%a8%e5%9f%9f%e4%b8%ad%e7%9a%84%e6%a0%87%e8%af%86%e7%ac%a6%e6%9d%a5%e5%a4%84%e7%90%86%ef%bc%8c%e4%bb%8e%e8%80%8c%e5%88%9b%e5%bb%ba%e4%ba%86%e4%b8%80%e4%b8%aa%e6%96%b0%e7%9a%84%e8%af%8d%e6%b3%95%e4%bd%9c%e7%94%a8%e5%9f%9f%ef%bc%88%e5%90%8c%e6%a0%b7%e6%98%af%e5%9c%a8%e8%bf%90%e8%a1%8c%e6%97%b6%ef%bc%89%e3%80%82%0a%e8%bf%99%e4%b8%a4%e4%b8%aa%e6%9c%ba%e5%88%b6%e7%9a%84%e5%89%af%e4%bd%9c%e7%94%a8%e6%98%af%e5%bc%95%e6%93%8e%e6%97%a0%e6%b3%95%e5%9c%a8%e7%bc%96%e8%af%91%e6%97%b6%e5%af%b9%e4%bd%9c%e7%94%a8%e5%9f%9f%e6%9f%a5%e6%89%be%e8%bf%9b%e8%a1%8c%e4%bc%98%e5%8c%96%ef%bc%8c%e5%9b%a0%e4%b8%ba%e5%bc%95%e6%93%8e%e5%8f%aa%e8%83%bd%e8%b0%a8%e6%85%8e%e5%9c%b0%e8%ae%a4%e4%b8%ba%e8%bf%99%e6%a0%b7%e7%9a%84%e4%bc%98%e5%8c%96%e6%98%af%e6%97%a0%e6%95%88%e7%9a%84%e3%80%82%e4%bd%bf%e7%94%a8%e8%bf%99%e5%85%b6%e4%b8%ad%e4%bb%bb%e4%bd%95%e4%b8%80%e4%b8%aa%e6%9c%ba%e5%88%b6%e9%83%bd%e5%b0%86%e5%af%bc%e8%87%b4%e4%bb%a3%e7%a0%81%e8%bf%90%e8%a1%8c%e5%8f%98%e6%85%a2%e3%80%82%e9%81%bf%e5%85%8d%e4%bd%bf%e7%94%a8%e5%ae%83%e4%bb%ac%e3%80%82%0a%e5%8a%a8%e6%80%81%e4%bd%9c%e7%94%a8%e5%9f%9f%20%e5%8a%a8%e6%80%81%e4%bd%9c%e7%94%a8%e5%9f%9f%e5%b9%b6%e4%b8%8d%e5%85%b3%e5%bf%83%e5%87%bd%e6%95%b0%e5%92%8c%e4%bd%9c%e7%94%a8%e5%9f%9f%e6%98%af%e5%a6%82%e4%bd%95%e5%a3%b0%e6%98%8e%e4%bb%a5%e5%8f%8a%e5%9c%a8%e4%bd%95%e5%a4%84%e5%a3%b0%e6%98%8e%e7%9a%84%ef%bc%8c%e5%8f%aa%e5%85%b3%e5%bf%83%e5%ae%83%e4%bb%ac%e4%bb%8e%e4%bd%95%e5%a4%84%e8%b0%83%e7%94%a8%e3%80%82%e6%8d%a2%e5%8f%a5%e8%af%9d%e8%af%b4%ef%bc%8c%e4%bd%9c%e7%94%a8%e5%9f%9f%e9%93%be%e6%98%af%e5%9f%ba%e4%ba%8e%e8%b0%83%e7%94%a8%e6%a0%88%e7%9a%84%ef%bc%8c%e8%80%8c%e4%b8%8d%e6%98%af%e4%bb%a3%e7%a0%81%e4%b8%ad%e7%9a%84%e4%bd%9c%e7%94%a8%e5%9f%9f%e5%b5%8c%e5%a5%97%e3%80%82%0a%e5%9b%a0%e6%ad%a4%ef%bc%8c%e5%a6%82%e6%9e%9c%20JavaScript%20%e5%85%b7%e6%9c%89%e5%8a%a8%e6%80%81%e4%bd%9c%e7%94%a8%e5%9f%9f%ef%bc%8c%e7%90%86%e8%ae%ba%e4%b8%8a%ef%bc%8c%e4%b8%8b%e9%9d%a2%e4%bb%a3%e7%a0%81%e4%b8%ad%e7%9a%84%20foo%28%29%20%e5%9c%a8%e6%89%a7%e8%a1%8c%e6%97%b6%e5%b0%86%e4%bc%9a%e8%be%93%e5%87%ba%203%e3%80%82%0a1function%20foo%28%29%20%7b%202%09console.log%28a%29%20%2f%2f%203%28%e4%b8%8d%e6%98%af%202%20%21%29%203%7d%204function%20bar%28%29%20%7b%205%20var%20a%20%3d%203%206%09foo%28%29%207%7d%208var%20a%20%3d%202%209bar%28%29%20%e4%b8%ba%e4%bb%80%e4%b9%88%e4%bc%9a%e8%bf%99%e6%a0%b7%ef%bc%9f%e5%9b%a0%e4%b8%ba%e5%bd%93%20foo%28%29%20%e6%97%a0%e6%b3%95%e6%89%be%e5%88%b0%20a%20%e7%9a%84%e5%8f%98%e9%87%8f%e5%bc%95%e7%94%a8%e6%97%b6%ef%bc%8c%e4%bc%9a%e9%a1%ba%e7%9d%80%e8%b0%83%e7%94%a8%e6%a0%88%e5%9c%a8%e8%b0%83%e7%94%a8%20foo%28%29%20%e7%9a%84%e5%9c%b0%e6%96%b9%e6%9f%a5%e6%89%be%20a%ef%bc%8c%e8%80%8c%e4%b8%8d%e6%98%af%e5%9c%a8%e5%b5%8c%e5%a5%97%e7%9a%84%e8%af%8d%e6%b3%95%e4%bd%9c%e7%94%a8%e5%9f%9f%e9%93%be%e4%b8%ad%e5%90%91%e4%b8%8a%e6%9f%a5%e6%89%be%e3%80%82%e7%94%b1%e4%ba%8e%20foo%28%29%20%e6%98%af%e5%9c%a8%20bar%28%29%20%e4%b8%ad%e8%b0%83%e7%94%a8%e7%9a%84%ef%bc%8c%e5%bc%95%e6%93%8e%e4%bc%9a%e6%a3%80%e6%9f%a5%20bar%28%29%20%e7%9a%84%e4%bd%9c%e7%94%a8%e5%9f%9f%ef%bc%8c%e5%b9%b6%e5%9c%a8%e5%85%b6%e4%b8%ad%e6%89%be%e5%88%b0%e5%80%bc%e4%b8%ba%203%20%e7%9a%84%e5%8f%98%e9%87%8f%20a%e3%80%82%0a%e9%9c%80%e8%a6%81%e6%98%8e%e7%a1%ae%e7%9a%84%e6%98%af%ef%bc%8c%e4%ba%8b%e5%ae%9e%e4%b8%8a%20JavaScript%20%e5%b9%b6%e4%b8%8d%e5%85%b7%e6%9c%89%e5%8a%a8%e6%80%81%e4%bd%9c%e7%94%a8%e5%9f%9f%e3%80%82%e5%ae%83%e5%8f%aa%e6%9c%89%e8%af%8d%e6%b3%95%e4%bd%9c%e7%94%a8%e5%9f%9f%ef%bc%8c%e7%ae%80%e5%8d%95%e6%98%8e%e4%ba%86%e3%80%82%e4%bd%86%e6%98%af%20this%20%e6%9c%ba%e5%88%b6%e6%9f%90%e7%a7%8d%e7%a8%8b%e5%ba%a6%e4%b8%8a%e5%be%88%e5%83%8f%e5%8a%a8%e6%80%81%e4%bd%9c%e7%94%a8%e5%9f%9f%e3%80%82" aria-label="Tumblr">
      <i class="fab fa-tumblr " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fgeekkery.4everland.app%2fposts%2f%25E4%25BD%259C%25E7%2594%25A8%25E5%259F%259F%25E5%2592%258C%25E9%2597%25AD%25E5%258C%2585%2f&t=%e4%bd%9c%e7%94%a8%e5%9f%9f%e5%92%8c%e9%97%ad%e5%8c%85" aria-label="Hacker News">
      <i class="fab fa-hacker-news " aria-hidden="true"></i>
    </a>
  </li>
</ul>

    </div>
    
    <div id="toc">
      <nav id="TableOfContents">
  <ul>
    <li><a href="#词法作用域">词法作用域</a>
      <ul>
        <li><a href="#欺骗词法">欺骗词法</a></li>
      </ul>
    </li>
    <li><a href="#动态作用域">动态作用域</a></li>
    <li><a href="#函数作用域和块作用域">函数作用域和块作用域</a></li>
    <li><a href="#提升">提升</a></li>
    <li><a href="#闭包">闭包</a>
      <ul>
        <li><a href="#循环和闭包">循环和闭包</a></li>
        <li><a href="#防抖debounce">防抖（debounce）</a></li>
        <li><a href="#节流throttle">节流（throttle）</a></li>
        <li><a href="#单例模式">单例模式</a></li>
        <li><a href="#模块化">模块化</a></li>
      </ul>
    </li>
  </ul>
</nav>
    </div>
    
  </span>
</div>


  <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
    <header>
      <h1 class="posttitle" itemprop="name headline">
        作用域和闭包
      </h1>
      <div class="meta">
        
        <div class="postdate">
          
          <time datetime="2021-01-18 15:03:44 &#43;0800 CST" itemprop="datePublished">2021-01-18</time>
          
        </div>
        
        
        <div class="article-read-time">
          <i class="far fa-clock"></i>
          
          12 minute read
        </div>
        
        
        
        <div class="article-tag">
            <i class="fas fa-tag"></i>
            
            
            <a class="tag-link" href="/tags/javascript" rel="tag">JavaScript</a>
            
        </div>
        
      </div>
    </header>

  
    
    <div class="content" itemprop="articleBody">
      <h2 id="词法作用域">词法作用域</h2>
<p>作用域是一套规则，这套规则用来管理引擎如何在当前的作用域以及嵌套的子作用域中根据标识符名称进行变量查找。作用域共有两种主要的工作模型。第一种是最为普遍的，被大多数编程语言所采用的<strong>词法作用域</strong>，另外一种叫做<strong>动态作用域</strong>，仍有一些编程语言在使用（比如 Bash 脚本、Perl 中的一些模式等）。JavaScript 中的作用域就是<strong>词法作用域</strong>。</p>
<p>词法作用域就是定义在词法阶段的作用域。换句话说，词法作用域是由你<strong>在写代码时将变量和块作用域写在哪里</strong>来决定的，因此当词法分析器处理代码时会保持作用域不变。无论函数在哪里被调用，也无论它如何被调用，它的词法作用域都只由<strong>函数被声明时所处的位置</strong>决定。</p>
<h3 id="欺骗词法">欺骗词法</h3>
<p>如果词法作用域完全由写代码期间函数所声明的位置来定义，怎样才能在运行时来“修改”（即欺骗）词法作用域呢？</p>
<p>JavaScript 中有两种机制来实现这个目的：eval(..) 函数和 with 关键字。前者可以对一段包含一个或多个声明的“代码”字符串进行演算，并借此来修改已经存在的词法作用域（在运行时）。后者本质上是通过将一个对象的引用当作作用域来处理，将对象的属性当作作用域中的标识符来处理，从而创建了一个新的词法作用域（同样是在运行时）。</p>
<p>这两个机制的副作用是引擎无法在编译时对作用域查找进行优化，因为引擎只能谨慎地认为这样的优化是无效的。使用这其中任何一个机制都将导致代码运行变慢。避免使用它们。</p>
<h2 id="动态作用域">动态作用域</h2>
<p>动态作用域并不关心函数和作用域是如何声明以及在何处声明的，只关心它们从何处调用。换句话说，作用域链是基于调用栈的，而不是代码中的作用域嵌套。</p>
<p>因此，如果 JavaScript 具有动态作用域，<strong>理论上</strong>，下面代码中的 foo() 在执行时将会输出 3。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span style="color:#8be9fd;font-style:italic">function</span> foo() {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span>	console.log(a) <span style="color:#6272a4">// 3(不是 2 !)
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span><span style="color:#6272a4"></span>}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span><span style="color:#8be9fd;font-style:italic">function</span> bar() {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5</span>  <span style="color:#8be9fd;font-style:italic">var</span> a <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">3</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6</span>	foo()
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7</span>}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8</span><span style="color:#8be9fd;font-style:italic">var</span> a <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">2</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">9</span>bar()
</code></pre></div><p>为什么会这样？因为当 foo() 无法找到 a 的变量引用时，会顺着调用栈在调用 foo() 的地方查找 a，而不是在嵌套的词法作用域链中向上查找。由于 foo() 是在 bar() 中调用的，引擎会检查 bar() 的作用域，并在其中找到值为 3 的变量 a。</p>
<p>需要明确的是，事实上 JavaScript 并不具有动态作用域。它只有词法作用域，简单明了。但是 this 机制某种程度上很像动态作用域。</p>
<p>词法作用域是在写代码或者说定义时确定的，而动态作用域是在运行时确定的。词法作用域关注函数在何处声明，而动态作用域关注函数从何处调用。</p>
<h2 id="函数作用域和块作用域">函数作用域和块作用域</h2>
<p>函数是 JavaScript 中最常见的作用域单元。本质上，声明在一个函数内部的变量或函数会在所处的作用域中“隐藏”起来，这是有意为之的良好软件的设计原则。但函数不是唯一的作用域单元。块作用域指的是变量和函数不仅可以属于所处的作用域，也可以属于某个代码块（通常指 { .. } 内部）。</p>
<p>从 ES3 开始，try/catch 结构在 catch 分句中具有块作用域，用 with 从对象中创建出的作用域仅在 with 声明中而非外部作用域中有效。在 ES6 中引入了 let 和 const 关键字，用来在任意代码块中声明变量。</p>
<p>函数作用域常被用于隐藏内部实现、规避命名冲突和模块管理等用途，如常用的立即执行函数表达式。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span style="color:#8be9fd;font-style:italic">var</span> a <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">2</span>;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span>(<span style="color:#8be9fd;font-style:italic">function</span> foo() { 
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span>  <span style="color:#8be9fd;font-style:italic">var</span> a <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">3</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5</span>  console.log(a) <span style="color:#6272a4">// 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6</span><span style="color:#6272a4"></span>})()
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8</span>console.log(a) <span style="color:#6272a4">// 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">9</span><span style="color:#6272a4"></span>
</code></pre></div><h2 id="提升">提升</h2>
<p>变量<strong>声明</strong>和函数<strong>声明</strong>在编译阶段会被提升，而包括函数表达式的赋值在内的赋值操作并不会提升。在提升过程中，<strong>函数声明优先</strong>。</p>
<h2 id="闭包">闭包</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span style="color:#8be9fd;font-style:italic">function</span> foo() {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span>  <span style="color:#8be9fd;font-style:italic">var</span> a <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">2</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span>  <span style="color:#8be9fd;font-style:italic">function</span> bar() {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span>    console.log(a)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5</span>  }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6</span>	<span style="color:#ff79c6">return</span> bar
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7</span>}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8</span><span style="color:#8be9fd;font-style:italic">var</span> baz <span style="color:#ff79c6">=</span> foo()
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">9</span>baz() <span style="color:#6272a4">// 2 —— 这就是闭包的效果。
</span></code></pre></div><p>函数 bar() 的词法作用域能够访问 foo() 的内部作用域。在 foo() 执行后，其返回值 bar 函数赋值给变量 baz 并调用 baz()，实际上只是通过不同的标识符引用调用了内部的函数 bar()。但是在这个例子中，它在自己定义的词法作用域以外的地方执行。</p>
<p>在 foo() 执行后，通常会期待 foo() 的整个内部作用域都被销毁，因为我们知道引擎有垃圾回收器用来释放不再使用的内存空间。由于看上去 foo() 的内容不会再被使用，所以很自然地会考虑对其进行回收。</p>
<p>而闭包的“神奇”之处正是可以阻止这件事情的发生。事实上内部作用域依然存在，因此没有被回收。谁在使用这个内部作用域？就是 bar() 本身在使用。</p>
<p><strong>函数在当前词法作用域之外执行时，依然可以记住并访问其所在的词法作用域，这时就产生了闭包</strong>。</p>
<p>在定时器、事件监听器、 AJAX 请求、跨窗口通信、Web Workers 或者任何其他的异步（或者同步）任务中，只要使用了回调函数，实际上就是在使用闭包！</p>
<p>由于闭包会使得外层函数中的变量常驻内存，消耗较大，因此不能滥用闭包，否则会造成网页的性能问题，使用不当会很容易造成内存泄露。闭包不在使用时，需要将内层函数变量赋值为 null，等待垃圾回收。</p>
<h3 id="循环和闭包">循环和闭包</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span style="color:#ff79c6">for</span> (<span style="color:#8be9fd;font-style:italic">var</span> i <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">1</span>; i <span style="color:#ff79c6">&lt;=</span> <span style="color:#bd93f9">5</span>; i<span style="color:#ff79c6">++</span>) {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span>    setTimeout(<span style="color:#8be9fd;font-style:italic">function</span> timer() {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span>        console.log(i)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span>    }, i <span style="color:#ff79c6">*</span> <span style="color:#bd93f9">1000</span>)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5</span>}
</code></pre></div><p>这段代码在运行时会以每秒一次的频率输出五次 6，而非预期的从 1 到 5。延迟函数的回调会在循环结束时才执行，当定时器运行时即使每个迭代中执行的是 setTimeout(.., 0)，所有的回调函数依然是在循 环结束后才会被执行，因此会每次输出一个 6 出来。</p>
<p>通过闭包修正：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span style="color:#ff79c6">for</span> (<span style="color:#8be9fd;font-style:italic">var</span> i <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">1</span>; i <span style="color:#ff79c6">&lt;=</span> <span style="color:#bd93f9">5</span>; i<span style="color:#ff79c6">++</span>) {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span>    (<span style="color:#8be9fd;font-style:italic">function</span> (j) {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span>        setTimeout(<span style="color:#8be9fd;font-style:italic">function</span> timer() {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span>            console.log(j)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5</span>        }, j <span style="color:#ff79c6">*</span> <span style="color:#bd93f9">1000</span>)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6</span>    })(i)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7</span>}
</code></pre></div><h3 id="防抖debounce">防抖（debounce）</h3>
<p>防抖即防止抖动，以免事件被频繁触发的同时，执行回调函数，浪费计算资源。防抖所应用的场景：</p>
<ul>
<li>登录、发短信等按钮需要处理用户的频繁点击，以避免多次请求发送请求</li>
<li>input 关联搜索展示下拉选择，当用户输入频率变慢到一定标准时执行请求</li>
<li>调整浏览器窗口大小时，resize 不断出发事件函数，造成频繁计算</li>
<li>文本编辑器实时保存，当无任何更改操作数秒后进行保存请求</li>
</ul>
<p>防抖的原理是，事件触发时给回调函数添加有延迟的定时器，如果在延迟时间内事件再次被触发，则使用 clearTimeout 清除定时器。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span style="color:#ff79c6">const</span> debounce <span style="color:#ff79c6">=</span> (func, delay) =&gt; {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span>    <span style="color:#8be9fd;font-style:italic">let</span> timer
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span>    <span style="color:#ff79c6">return</span> (...args) =&gt; {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span>        clearTimeout(timer)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span>        timer <span style="color:#ff79c6">=</span> setTimeout(() =&gt; {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span>            func.apply(<span style="color:#ff79c6">this</span>, [args])
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span>        }, delay)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span>}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span><span style="color:#ff79c6">const</span> debounceMousemove <span style="color:#ff79c6">=</span> debounce(e =&gt; {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span>    console.log(<span style="color:#f1fa8c">`Event data：</span><span style="color:#f1fa8c">${</span>e<span style="color:#f1fa8c">}</span><span style="color:#f1fa8c">`</span>)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span>}, <span style="color:#bd93f9">300</span>)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16</span><span style="color:#8be9fd;font-style:italic">document</span>.addEventListener(<span style="color:#f1fa8c">&#39;mousemove&#39;</span>, <span style="color:#8be9fd;font-style:italic">function</span> (e) {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17</span>    console.log(<span style="color:#f1fa8c">&#39;mousemove&#39;</span>)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18</span>    debounceMousemove(e)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19</span>})
</code></pre></div><h3 id="节流throttle">节流（throttle）</h3>
<p>节流即控制流量，首先选择适当的间隔时间如 1s，事件被频繁触发期间，固定每隔 1s 执行一次事件回调函数。节流的应用场景：</p>
<ul>
<li>监听 scroll 事件，当滑到底部自动加载更多的内容，用节流降低计算频率</li>
<li>音视频播放时，每隔 1s 计算一次进度信息</li>
</ul>
<p>相对于防抖，节流的重点在加锁，只要定时器存在便不理会，否则添加定时器，并在其执行后使用赋值为 null 的方式清除定时器。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span style="color:#ff79c6">const</span> throttle <span style="color:#ff79c6">=</span> (func, interval) =&gt; {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span>    <span style="color:#8be9fd;font-style:italic">let</span> timer
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span>  
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span>    <span style="color:#ff79c6">return</span> (...args) =&gt; {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span>        <span style="color:#ff79c6">if</span> (timer) { <span style="color:#ff79c6">return</span> }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span>        timer <span style="color:#ff79c6">=</span> setTimeout(() =&gt; {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span>            func.apply(<span style="color:#ff79c6">this</span>, [args])
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span>            timer <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">null</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span>        }, interval)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span>}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span><span style="color:#ff79c6">const</span> throttleMousemove <span style="color:#ff79c6">=</span> throttle(e =&gt; {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span>    console.log(<span style="color:#f1fa8c">`Event data：</span><span style="color:#f1fa8c">${</span>e<span style="color:#f1fa8c">}</span><span style="color:#f1fa8c">`</span>)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span>}, <span style="color:#bd93f9">500</span>)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17</span><span style="color:#8be9fd;font-style:italic">document</span>.addEventListener(<span style="color:#f1fa8c">&#39;mousemove&#39;</span>, <span style="color:#8be9fd;font-style:italic">function</span> (e) {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18</span>    console.log(<span style="color:#f1fa8c">&#39;mousemove&#39;</span>)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19</span>    throttleMousemove(e)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20</span>})
</code></pre></div><h3 id="单例模式">单例模式</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span style="color:#ff79c6">class</span> UserSingleton {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span>    constructor(name) {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span>        <span style="color:#ff79c6">this</span>.name <span style="color:#ff79c6">=</span> name
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span>        <span style="color:#ff79c6">this</span>.getName()
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span>    getName() {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span>        <span style="color:#ff79c6">return</span> <span style="color:#ff79c6">this</span>.name
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span>}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span><span style="color:#ff79c6">const</span> Singleton <span style="color:#ff79c6">=</span> (<span style="color:#8be9fd;font-style:italic">function</span> () {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span>    <span style="color:#8be9fd;font-style:italic">let</span> instance <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">null</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span>    <span style="color:#ff79c6">return</span> <span style="color:#8be9fd;font-style:italic">function</span> (name) {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16</span>        <span style="color:#ff79c6">if</span> (<span style="color:#ff79c6">!</span>instance) {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17</span>            instance <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> UserSingleton(name)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18</span>        }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19</span>        <span style="color:#ff79c6">return</span> instance
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20</span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21</span>})()
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23</span><span style="color:#ff79c6">const</span> bob <span style="color:#ff79c6">=</span> Singleton(<span style="color:#f1fa8c">&#34;bob&#34;</span>)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24</span><span style="color:#ff79c6">const</span> jack <span style="color:#ff79c6">=</span> Singleton(<span style="color:#f1fa8c">&#34;jack&#34;</span>)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26</span>console.log(bob <span style="color:#ff79c6">===</span> jack)    <span style="color:#6272a4">// true
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27</span><span style="color:#6272a4"></span>console.log(bob, jack)	     <span style="color:#6272a4">// UserSingleton { name: &#39;bob&#39; } UserSingleton { name: &#39;bob&#39; }
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28</span><span style="color:#6272a4"></span>
</code></pre></div><h3 id="模块化">模块化</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span style="color:#8be9fd;font-style:italic">var</span> Module <span style="color:#ff79c6">=</span> (<span style="color:#8be9fd;font-style:italic">function</span> Manager() {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span>    <span style="color:#8be9fd;font-style:italic">var</span> modules <span style="color:#ff79c6">=</span> {}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span>    <span style="color:#8be9fd;font-style:italic">function</span> define(name, deps, impl) {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span>        <span style="color:#ff79c6">for</span> (<span style="color:#8be9fd;font-style:italic">var</span> i <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">0</span>; i <span style="color:#ff79c6">&lt;</span> deps.length; i<span style="color:#ff79c6">++</span>) {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span>            deps[i] <span style="color:#ff79c6">=</span> modules[deps[i]]
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span>        }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span>        modules[name] <span style="color:#ff79c6">=</span> impl.apply(impl, deps)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span>    <span style="color:#8be9fd;font-style:italic">function</span> get(name) {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span>        <span style="color:#ff79c6">return</span> modules[name]
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span>    <span style="color:#ff79c6">return</span> {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16</span>        define<span style="color:#ff79c6">:</span> define,
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17</span>        get<span style="color:#ff79c6">:</span> get
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18</span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19</span>})()
</code></pre></div>
    </div>
  </article>

  
  






  <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/posts">Writings</a></li>
         
          <li><a href="/tags">Tags</a></li>
         
          <li><a href="/about">About</a></li>
        
      </ul>
    </div>

    
    <div id="toc-footer" style="display: none">
      <nav id="TableOfContents">
  <ul>
    <li><a href="#词法作用域">词法作用域</a>
      <ul>
        <li><a href="#欺骗词法">欺骗词法</a></li>
      </ul>
    </li>
    <li><a href="#动态作用域">动态作用域</a></li>
    <li><a href="#函数作用域和块作用域">函数作用域和块作用域</a></li>
    <li><a href="#提升">提升</a></li>
    <li><a href="#闭包">闭包</a>
      <ul>
        <li><a href="#循环和闭包">循环和闭包</a></li>
        <li><a href="#防抖debounce">防抖（debounce）</a></li>
        <li><a href="#节流throttle">节流（throttle）</a></li>
        <li><a href="#单例模式">单例模式</a></li>
        <li><a href="#模块化">模块化</a></li>
      </ul>
    </li>
  </ul>
</nav>
    </div>
    

    <div id="share-footer" style="display: none">
      
      <ul>
  
  
    
  
  
  <li>
    <a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fgeekkery.4everland.app%2fposts%2f%25E4%25BD%259C%25E7%2594%25A8%25E5%259F%259F%25E5%2592%258C%25E9%2597%25AD%25E5%258C%2585%2f" aria-label="Facebook">
      <i class="fab fa-facebook fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://twitter.com/share?url=https%3a%2f%2fgeekkery.4everland.app%2fposts%2f%25E4%25BD%259C%25E7%2594%25A8%25E5%259F%259F%25E5%2592%258C%25E9%2597%25AD%25E5%258C%2585%2f&text=%e4%bd%9c%e7%94%a8%e5%9f%9f%e5%92%8c%e9%97%ad%e5%8c%85" aria-label="Twitter">
      <i class="fab fa-twitter fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fgeekkery.4everland.app%2fposts%2f%25E4%25BD%259C%25E7%2594%25A8%25E5%259F%259F%25E5%2592%258C%25E9%2597%25AD%25E5%258C%2585%2f&title=%e4%bd%9c%e7%94%a8%e5%9f%9f%e5%92%8c%e9%97%ad%e5%8c%85" aria-label="Linkedin">
      <i class="fab fa-linkedin fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fgeekkery.4everland.app%2fposts%2f%25E4%25BD%259C%25E7%2594%25A8%25E5%259F%259F%25E5%2592%258C%25E9%2597%25AD%25E5%258C%2585%2f&is_video=false&description=%e4%bd%9c%e7%94%a8%e5%9f%9f%e5%92%8c%e9%97%ad%e5%8c%85" aria-label="Pinterest">
      <i class="fab fa-pinterest fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="mailto:?subject=%e4%bd%9c%e7%94%a8%e5%9f%9f%e5%92%8c%e9%97%ad%e5%8c%85&body=Check out this article: https%3a%2f%2fgeekkery.4everland.app%2fposts%2f%25E4%25BD%259C%25E7%2594%25A8%25E5%259F%259F%25E5%2592%258C%25E9%2597%25AD%25E5%258C%2585%2f" aria-label="Email">
      <i class="fas fa-envelope fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2fgeekkery.4everland.app%2fposts%2f%25E4%25BD%259C%25E7%2594%25A8%25E5%259F%259F%25E5%2592%258C%25E9%2597%25AD%25E5%258C%2585%2f&title=%e4%bd%9c%e7%94%a8%e5%9f%9f%e5%92%8c%e9%97%ad%e5%8c%85" aria-label="Pocket">
      <i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2fgeekkery.4everland.app%2fposts%2f%25E4%25BD%259C%25E7%2594%25A8%25E5%259F%259F%25E5%2592%258C%25E9%2597%25AD%25E5%258C%2585%2f&title=%e4%bd%9c%e7%94%a8%e5%9f%9f%e5%92%8c%e9%97%ad%e5%8c%85" aria-label="reddit">
      <i class="fab fa-reddit fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.tumblr.com/share/link?url=https%3a%2f%2fgeekkery.4everland.app%2fposts%2f%25E4%25BD%259C%25E7%2594%25A8%25E5%259F%259F%25E5%2592%258C%25E9%2597%25AD%25E5%258C%2585%2f&name=%e4%bd%9c%e7%94%a8%e5%9f%9f%e5%92%8c%e9%97%ad%e5%8c%85&description=%e8%af%8d%e6%b3%95%e4%bd%9c%e7%94%a8%e5%9f%9f%20%e4%bd%9c%e7%94%a8%e5%9f%9f%e6%98%af%e4%b8%80%e5%a5%97%e8%a7%84%e5%88%99%ef%bc%8c%e8%bf%99%e5%a5%97%e8%a7%84%e5%88%99%e7%94%a8%e6%9d%a5%e7%ae%a1%e7%90%86%e5%bc%95%e6%93%8e%e5%a6%82%e4%bd%95%e5%9c%a8%e5%bd%93%e5%89%8d%e7%9a%84%e4%bd%9c%e7%94%a8%e5%9f%9f%e4%bb%a5%e5%8f%8a%e5%b5%8c%e5%a5%97%e7%9a%84%e5%ad%90%e4%bd%9c%e7%94%a8%e5%9f%9f%e4%b8%ad%e6%a0%b9%e6%8d%ae%e6%a0%87%e8%af%86%e7%ac%a6%e5%90%8d%e7%a7%b0%e8%bf%9b%e8%a1%8c%e5%8f%98%e9%87%8f%e6%9f%a5%e6%89%be%e3%80%82%e4%bd%9c%e7%94%a8%e5%9f%9f%e5%85%b1%e6%9c%89%e4%b8%a4%e7%a7%8d%e4%b8%bb%e8%a6%81%e7%9a%84%e5%b7%a5%e4%bd%9c%e6%a8%a1%e5%9e%8b%e3%80%82%e7%ac%ac%e4%b8%80%e7%a7%8d%e6%98%af%e6%9c%80%e4%b8%ba%e6%99%ae%e9%81%8d%e7%9a%84%ef%bc%8c%e8%a2%ab%e5%a4%a7%e5%a4%9a%e6%95%b0%e7%bc%96%e7%a8%8b%e8%af%ad%e8%a8%80%e6%89%80%e9%87%87%e7%94%a8%e7%9a%84%e8%af%8d%e6%b3%95%e4%bd%9c%e7%94%a8%e5%9f%9f%ef%bc%8c%e5%8f%a6%e5%a4%96%e4%b8%80%e7%a7%8d%e5%8f%ab%e5%81%9a%e5%8a%a8%e6%80%81%e4%bd%9c%e7%94%a8%e5%9f%9f%ef%bc%8c%e4%bb%8d%e6%9c%89%e4%b8%80%e4%ba%9b%e7%bc%96%e7%a8%8b%e8%af%ad%e8%a8%80%e5%9c%a8%e4%bd%bf%e7%94%a8%ef%bc%88%e6%af%94%e5%a6%82%20Bash%20%e8%84%9a%e6%9c%ac%e3%80%81Perl%20%e4%b8%ad%e7%9a%84%e4%b8%80%e4%ba%9b%e6%a8%a1%e5%bc%8f%e7%ad%89%ef%bc%89%e3%80%82JavaScript%20%e4%b8%ad%e7%9a%84%e4%bd%9c%e7%94%a8%e5%9f%9f%e5%b0%b1%e6%98%af%e8%af%8d%e6%b3%95%e4%bd%9c%e7%94%a8%e5%9f%9f%e3%80%82%0a%e8%af%8d%e6%b3%95%e4%bd%9c%e7%94%a8%e5%9f%9f%e5%b0%b1%e6%98%af%e5%ae%9a%e4%b9%89%e5%9c%a8%e8%af%8d%e6%b3%95%e9%98%b6%e6%ae%b5%e7%9a%84%e4%bd%9c%e7%94%a8%e5%9f%9f%e3%80%82%e6%8d%a2%e5%8f%a5%e8%af%9d%e8%af%b4%ef%bc%8c%e8%af%8d%e6%b3%95%e4%bd%9c%e7%94%a8%e5%9f%9f%e6%98%af%e7%94%b1%e4%bd%a0%e5%9c%a8%e5%86%99%e4%bb%a3%e7%a0%81%e6%97%b6%e5%b0%86%e5%8f%98%e9%87%8f%e5%92%8c%e5%9d%97%e4%bd%9c%e7%94%a8%e5%9f%9f%e5%86%99%e5%9c%a8%e5%93%aa%e9%87%8c%e6%9d%a5%e5%86%b3%e5%ae%9a%e7%9a%84%ef%bc%8c%e5%9b%a0%e6%ad%a4%e5%bd%93%e8%af%8d%e6%b3%95%e5%88%86%e6%9e%90%e5%99%a8%e5%a4%84%e7%90%86%e4%bb%a3%e7%a0%81%e6%97%b6%e4%bc%9a%e4%bf%9d%e6%8c%81%e4%bd%9c%e7%94%a8%e5%9f%9f%e4%b8%8d%e5%8f%98%e3%80%82%e6%97%a0%e8%ae%ba%e5%87%bd%e6%95%b0%e5%9c%a8%e5%93%aa%e9%87%8c%e8%a2%ab%e8%b0%83%e7%94%a8%ef%bc%8c%e4%b9%9f%e6%97%a0%e8%ae%ba%e5%ae%83%e5%a6%82%e4%bd%95%e8%a2%ab%e8%b0%83%e7%94%a8%ef%bc%8c%e5%ae%83%e7%9a%84%e8%af%8d%e6%b3%95%e4%bd%9c%e7%94%a8%e5%9f%9f%e9%83%bd%e5%8f%aa%e7%94%b1%e5%87%bd%e6%95%b0%e8%a2%ab%e5%a3%b0%e6%98%8e%e6%97%b6%e6%89%80%e5%a4%84%e7%9a%84%e4%bd%8d%e7%bd%ae%e5%86%b3%e5%ae%9a%e3%80%82%0a%e6%ac%ba%e9%aa%97%e8%af%8d%e6%b3%95%20%e5%a6%82%e6%9e%9c%e8%af%8d%e6%b3%95%e4%bd%9c%e7%94%a8%e5%9f%9f%e5%ae%8c%e5%85%a8%e7%94%b1%e5%86%99%e4%bb%a3%e7%a0%81%e6%9c%9f%e9%97%b4%e5%87%bd%e6%95%b0%e6%89%80%e5%a3%b0%e6%98%8e%e7%9a%84%e4%bd%8d%e7%bd%ae%e6%9d%a5%e5%ae%9a%e4%b9%89%ef%bc%8c%e6%80%8e%e6%a0%b7%e6%89%8d%e8%83%bd%e5%9c%a8%e8%bf%90%e8%a1%8c%e6%97%b6%e6%9d%a5%e2%80%9c%e4%bf%ae%e6%94%b9%e2%80%9d%ef%bc%88%e5%8d%b3%e6%ac%ba%e9%aa%97%ef%bc%89%e8%af%8d%e6%b3%95%e4%bd%9c%e7%94%a8%e5%9f%9f%e5%91%a2%ef%bc%9f%0aJavaScript%20%e4%b8%ad%e6%9c%89%e4%b8%a4%e7%a7%8d%e6%9c%ba%e5%88%b6%e6%9d%a5%e5%ae%9e%e7%8e%b0%e8%bf%99%e4%b8%aa%e7%9b%ae%e7%9a%84%ef%bc%9aeval%28..%29%20%e5%87%bd%e6%95%b0%e5%92%8c%20with%20%e5%85%b3%e9%94%ae%e5%ad%97%e3%80%82%e5%89%8d%e8%80%85%e5%8f%af%e4%bb%a5%e5%af%b9%e4%b8%80%e6%ae%b5%e5%8c%85%e5%90%ab%e4%b8%80%e4%b8%aa%e6%88%96%e5%a4%9a%e4%b8%aa%e5%a3%b0%e6%98%8e%e7%9a%84%e2%80%9c%e4%bb%a3%e7%a0%81%e2%80%9d%e5%ad%97%e7%ac%a6%e4%b8%b2%e8%bf%9b%e8%a1%8c%e6%bc%94%e7%ae%97%ef%bc%8c%e5%b9%b6%e5%80%9f%e6%ad%a4%e6%9d%a5%e4%bf%ae%e6%94%b9%e5%b7%b2%e7%bb%8f%e5%ad%98%e5%9c%a8%e7%9a%84%e8%af%8d%e6%b3%95%e4%bd%9c%e7%94%a8%e5%9f%9f%ef%bc%88%e5%9c%a8%e8%bf%90%e8%a1%8c%e6%97%b6%ef%bc%89%e3%80%82%e5%90%8e%e8%80%85%e6%9c%ac%e8%b4%a8%e4%b8%8a%e6%98%af%e9%80%9a%e8%bf%87%e5%b0%86%e4%b8%80%e4%b8%aa%e5%af%b9%e8%b1%a1%e7%9a%84%e5%bc%95%e7%94%a8%e5%bd%93%e4%bd%9c%e4%bd%9c%e7%94%a8%e5%9f%9f%e6%9d%a5%e5%a4%84%e7%90%86%ef%bc%8c%e5%b0%86%e5%af%b9%e8%b1%a1%e7%9a%84%e5%b1%9e%e6%80%a7%e5%bd%93%e4%bd%9c%e4%bd%9c%e7%94%a8%e5%9f%9f%e4%b8%ad%e7%9a%84%e6%a0%87%e8%af%86%e7%ac%a6%e6%9d%a5%e5%a4%84%e7%90%86%ef%bc%8c%e4%bb%8e%e8%80%8c%e5%88%9b%e5%bb%ba%e4%ba%86%e4%b8%80%e4%b8%aa%e6%96%b0%e7%9a%84%e8%af%8d%e6%b3%95%e4%bd%9c%e7%94%a8%e5%9f%9f%ef%bc%88%e5%90%8c%e6%a0%b7%e6%98%af%e5%9c%a8%e8%bf%90%e8%a1%8c%e6%97%b6%ef%bc%89%e3%80%82%0a%e8%bf%99%e4%b8%a4%e4%b8%aa%e6%9c%ba%e5%88%b6%e7%9a%84%e5%89%af%e4%bd%9c%e7%94%a8%e6%98%af%e5%bc%95%e6%93%8e%e6%97%a0%e6%b3%95%e5%9c%a8%e7%bc%96%e8%af%91%e6%97%b6%e5%af%b9%e4%bd%9c%e7%94%a8%e5%9f%9f%e6%9f%a5%e6%89%be%e8%bf%9b%e8%a1%8c%e4%bc%98%e5%8c%96%ef%bc%8c%e5%9b%a0%e4%b8%ba%e5%bc%95%e6%93%8e%e5%8f%aa%e8%83%bd%e8%b0%a8%e6%85%8e%e5%9c%b0%e8%ae%a4%e4%b8%ba%e8%bf%99%e6%a0%b7%e7%9a%84%e4%bc%98%e5%8c%96%e6%98%af%e6%97%a0%e6%95%88%e7%9a%84%e3%80%82%e4%bd%bf%e7%94%a8%e8%bf%99%e5%85%b6%e4%b8%ad%e4%bb%bb%e4%bd%95%e4%b8%80%e4%b8%aa%e6%9c%ba%e5%88%b6%e9%83%bd%e5%b0%86%e5%af%bc%e8%87%b4%e4%bb%a3%e7%a0%81%e8%bf%90%e8%a1%8c%e5%8f%98%e6%85%a2%e3%80%82%e9%81%bf%e5%85%8d%e4%bd%bf%e7%94%a8%e5%ae%83%e4%bb%ac%e3%80%82%0a%e5%8a%a8%e6%80%81%e4%bd%9c%e7%94%a8%e5%9f%9f%20%e5%8a%a8%e6%80%81%e4%bd%9c%e7%94%a8%e5%9f%9f%e5%b9%b6%e4%b8%8d%e5%85%b3%e5%bf%83%e5%87%bd%e6%95%b0%e5%92%8c%e4%bd%9c%e7%94%a8%e5%9f%9f%e6%98%af%e5%a6%82%e4%bd%95%e5%a3%b0%e6%98%8e%e4%bb%a5%e5%8f%8a%e5%9c%a8%e4%bd%95%e5%a4%84%e5%a3%b0%e6%98%8e%e7%9a%84%ef%bc%8c%e5%8f%aa%e5%85%b3%e5%bf%83%e5%ae%83%e4%bb%ac%e4%bb%8e%e4%bd%95%e5%a4%84%e8%b0%83%e7%94%a8%e3%80%82%e6%8d%a2%e5%8f%a5%e8%af%9d%e8%af%b4%ef%bc%8c%e4%bd%9c%e7%94%a8%e5%9f%9f%e9%93%be%e6%98%af%e5%9f%ba%e4%ba%8e%e8%b0%83%e7%94%a8%e6%a0%88%e7%9a%84%ef%bc%8c%e8%80%8c%e4%b8%8d%e6%98%af%e4%bb%a3%e7%a0%81%e4%b8%ad%e7%9a%84%e4%bd%9c%e7%94%a8%e5%9f%9f%e5%b5%8c%e5%a5%97%e3%80%82%0a%e5%9b%a0%e6%ad%a4%ef%bc%8c%e5%a6%82%e6%9e%9c%20JavaScript%20%e5%85%b7%e6%9c%89%e5%8a%a8%e6%80%81%e4%bd%9c%e7%94%a8%e5%9f%9f%ef%bc%8c%e7%90%86%e8%ae%ba%e4%b8%8a%ef%bc%8c%e4%b8%8b%e9%9d%a2%e4%bb%a3%e7%a0%81%e4%b8%ad%e7%9a%84%20foo%28%29%20%e5%9c%a8%e6%89%a7%e8%a1%8c%e6%97%b6%e5%b0%86%e4%bc%9a%e8%be%93%e5%87%ba%203%e3%80%82%0a1function%20foo%28%29%20%7b%202%09console.log%28a%29%20%2f%2f%203%28%e4%b8%8d%e6%98%af%202%20%21%29%203%7d%204function%20bar%28%29%20%7b%205%20var%20a%20%3d%203%206%09foo%28%29%207%7d%208var%20a%20%3d%202%209bar%28%29%20%e4%b8%ba%e4%bb%80%e4%b9%88%e4%bc%9a%e8%bf%99%e6%a0%b7%ef%bc%9f%e5%9b%a0%e4%b8%ba%e5%bd%93%20foo%28%29%20%e6%97%a0%e6%b3%95%e6%89%be%e5%88%b0%20a%20%e7%9a%84%e5%8f%98%e9%87%8f%e5%bc%95%e7%94%a8%e6%97%b6%ef%bc%8c%e4%bc%9a%e9%a1%ba%e7%9d%80%e8%b0%83%e7%94%a8%e6%a0%88%e5%9c%a8%e8%b0%83%e7%94%a8%20foo%28%29%20%e7%9a%84%e5%9c%b0%e6%96%b9%e6%9f%a5%e6%89%be%20a%ef%bc%8c%e8%80%8c%e4%b8%8d%e6%98%af%e5%9c%a8%e5%b5%8c%e5%a5%97%e7%9a%84%e8%af%8d%e6%b3%95%e4%bd%9c%e7%94%a8%e5%9f%9f%e9%93%be%e4%b8%ad%e5%90%91%e4%b8%8a%e6%9f%a5%e6%89%be%e3%80%82%e7%94%b1%e4%ba%8e%20foo%28%29%20%e6%98%af%e5%9c%a8%20bar%28%29%20%e4%b8%ad%e8%b0%83%e7%94%a8%e7%9a%84%ef%bc%8c%e5%bc%95%e6%93%8e%e4%bc%9a%e6%a3%80%e6%9f%a5%20bar%28%29%20%e7%9a%84%e4%bd%9c%e7%94%a8%e5%9f%9f%ef%bc%8c%e5%b9%b6%e5%9c%a8%e5%85%b6%e4%b8%ad%e6%89%be%e5%88%b0%e5%80%bc%e4%b8%ba%203%20%e7%9a%84%e5%8f%98%e9%87%8f%20a%e3%80%82%0a%e9%9c%80%e8%a6%81%e6%98%8e%e7%a1%ae%e7%9a%84%e6%98%af%ef%bc%8c%e4%ba%8b%e5%ae%9e%e4%b8%8a%20JavaScript%20%e5%b9%b6%e4%b8%8d%e5%85%b7%e6%9c%89%e5%8a%a8%e6%80%81%e4%bd%9c%e7%94%a8%e5%9f%9f%e3%80%82%e5%ae%83%e5%8f%aa%e6%9c%89%e8%af%8d%e6%b3%95%e4%bd%9c%e7%94%a8%e5%9f%9f%ef%bc%8c%e7%ae%80%e5%8d%95%e6%98%8e%e4%ba%86%e3%80%82%e4%bd%86%e6%98%af%20this%20%e6%9c%ba%e5%88%b6%e6%9f%90%e7%a7%8d%e7%a8%8b%e5%ba%a6%e4%b8%8a%e5%be%88%e5%83%8f%e5%8a%a8%e6%80%81%e4%bd%9c%e7%94%a8%e5%9f%9f%e3%80%82" aria-label="Tumblr">
      <i class="fab fa-tumblr fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fgeekkery.4everland.app%2fposts%2f%25E4%25BD%259C%25E7%2594%25A8%25E5%259F%259F%25E5%2592%258C%25E9%2597%25AD%25E5%258C%2585%2f&t=%e4%bd%9c%e7%94%a8%e5%9f%9f%e5%92%8c%e9%97%ad%e5%8c%85" aria-label="Hacker News">
      <i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i>
    </a>
  </li>
</ul>

    </div>

    <div id="actions-footer">
      
        <a id="menu-toggle" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;" aria-label="Menu">
          <i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        
        <a id="toc-toggle" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;" aria-label="TOC">
          <i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        
        <a id="share-toggle" class="icon" href="#" onclick="$('#share-footer').toggle();return false;" aria-label="Share">
          <i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" aria-label="Top of Page">
          <i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>


  <footer id="footer">
  <div class="footer-left">
    Copyright  &copy; 2022  GeekKery 
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
        <li><a href="/">Home</a></li>
         
        <li><a href="/posts">Writings</a></li>
         
        <li><a href="/tags">Tags</a></li>
         
        <li><a href="/about">About</a></li>
        
      </ul>
    </nav>
  </div>
</footer>


  </div>
</body>

<link rel="stylesheet" href=/lib/font-awesome/css/all.min.css>
<script src=/lib/jquery/jquery.min.js></script>
<script src=/js/main.js></script>

<script src=/js/code-copy.js></script>




</html>
